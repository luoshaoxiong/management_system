webpackJsonp([1],{"/Cih":function(t,e){},0:function(t,e){},"1+h8":function(t,e){},"1t/z":function(t,e){},"3S2X":function(t,e){},"6iW9":function(t,e){},"8XJx":function(t,e){},ILMH:function(t,e){},KWGG:function(t,e){},Lkh9:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("7+uW"),s={logout:"/logout",getProjectList:"/projects/getProjectList",createProject:"/projects/createProject",updateProject:"/projects/updateProject",deleteProject:"/projects/deleteProject",getQuestionList:"/library/getQueList",addQuestion:"/library/addQuestion",updateQuestion:"/library/updateQuestion",deleteQuestion:"/library/deleteQuestion",chat:"/chat"},n=i("NYxO"),r=i("bOdI"),o=i.n(r),c=i("Dd8w"),l=i.n(c),u=i("mLlr"),d=i.n(u),h=i("mvHQ"),p=i.n(h),f=i("//Fk"),m=i.n(f),v=[{pj_id:"0",code:"1231",cls:["分类一","分类二","分类三"],name:"默认项目"},{pj_id:"1",code:"1232",cls:["分类一","分类二","分类三"],name:"default"},{pj_id:"2",code:"1233",cls:["分类一","分类二","分类三"],name:"测试项目"},{pj_id:"3",code:"1234",cls:["分类一","分类二","分类三"],name:"大雄项目"},{pj_id:"4",code:"1235",cls:["分类一","分类二","分类三"],name:"test"}];function g(){return new m.a(function(t,e){try{t(JSON.parse(p()(v)))}catch(t){e(t)}})}var _={props:{placeholder:{type:String,default:""},value:{type:[String,Number],required:!0},type:{type:String,default:"text"},rows:{type:Number}},data:function(){return{inputValue:this.value}},watch:{inputValue:function(t){this.$emit("input",t)}},methods:{keydownInput:function(t){"Enter"===t.code&&(this.inputValue=t.target.value)},keyupInput:function(t){t.isComposing||(this.inputValue=t.target.value)},blurInput:function(t){this.inputValue=t.target.value}}},b={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("el-input",{attrs:{type:"textarea"===t.type?"textarea":"text",placeholder:t.placeholder,resize:"none",rows:t.rows},on:{blur:function(e){return t.blurInput(e)}},nativeOn:{keydown:function(e){return t.keydownInput(e)},keyup:function(e){return t.keyupInput(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}})},staticRenderFns:[]},C=i("VU/8")(_,b,!1,null,null,null).exports,x={props:{title:{type:String,required:!0},width:{type:String,default:"500px"},certainBtnText:{type:String,default:"确定"},cancelBtnText:{type:String,default:"取消"},isSubmitting:{type:Boolean,default:!1}},data:function(){return{}},methods:{beforeClose:function(){this.$emit("close")},beforeSubmit:function(){this.$emit("submit")}}},w={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.title,width:t.width,visible:!0,"before-close":t.beforeClose,"close-on-click-modal":!1}},[i("main",{staticClass:"form-dialog-content clearfix"},[t._t("default")],2),t._v(" "),i("footer",{staticClass:"form-dialog-footer"},[i("el-button",{on:{click:function(e){return t.beforeClose()}}},[t._v(t._s(t.cancelBtnText))]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.isSubmitting},on:{click:function(e){return t.beforeSubmit()}}},[t._v(t._s(t.certainBtnText))])],1)])},staticRenderFns:[]};var y=i("VU/8")(x,w,!1,function(t){i("PbDA")},null,null).exports,j={components:{vInput:C,formDialog:y},props:{project:{type:Object,default:function(){return{}}}},data:function(){return{projectName:{value:this.project.name||"",charLimit:20,verificationTip:"",isOverCharLimit:!1},projectCode:{value:this.project.code||"",charLimit:20,verificationTip:"",isOverCharLimit:!1},isSubmitting:!1}},watch:{"projectName.value":function(t){this.projectName.isOverCharLimit=t.length>this.projectName.charLimit,this.projectName.isOverCharLimit&&(this.projectName.verificationTip="")},"projectCode.value":function(t){this.projectCode.isOverCharLimit=t.length>this.projectCode.charLimit,this.projectCode.isOverCharLimit&&(this.projectCode.verificationTip="")}},computed:{isEdit:function(){return this.project.name}},mounted:function(){var t=this;setTimeout(function(){return t.$refs.nameInput.$children[0].focus()},0)},methods:{beforeClose:function(){var t=this;setTimeout(function(){return t.$emit("close")},0)},beforeSubmit:function(){this.project.name&&this.projectName===this.project.name?this.beforeClose():this.projectName.isOverCharLimit||this.projectCode.isOverCharLimit||(""===this.projectName.value.trim()?(this.projectName.verificationTip="项目名称不能为空或连续空格",this.$refs.nameInput.$children[0].focus()):this.isValueExisting(this.projectName.value,"name")?(this.projectName.verificationTip="项目名称已存在",this.$refs.nameInput.$children[0].focus()):""===this.projectCode.value.trim()?(this.projectCode.verificationTip="项目代号不能为空或连续空格",this.$refs.codeInput.$children[0].focus()):this.isValueExisting(this.projectCode.value,"code")?(this.projectCode.verificationTip="项目代号已存在",this.$refs.codeInput.$children[0].focus()):this.isEdit?this.update(this.project.pj_id,this.projectName.value,this.projectCode.value):this.create(this.projectName.value,this.projectCode.value))},isValueExisting:function(t,e){return(!this.isEdit||t!==this.project[e])&&this.$store.state.projectList.some(function(i){return i[e]===t})},create:function(t,e){var i=this;this.isSubmitting=!0,function(t,e){return new m.a(function(i,a){try{var s=String(v.length);v.splice(0,0,{pj_id:s,code:e,cls:["分类一","分类二","分类三"],name:t}),i(s)}catch(t){throw new Error(t)}})}(t,e).then(function(a){i.$message.success("创建成功");var s={pj_id:a,name:t,code:e};g().then(function(t){i.$store.dispatch("setProjectList",t),i.$store.dispatch("switchProject",s),i.isSubmitting=!1,i.beforeClose()}).catch(function(){i.$message.error("获取项目信息失败")})}).catch(function(){i.$message.error("创建项目失败"),i.isSubmitting=!1})},update:function(t,e,i){var a=this;this.isSubmitting=!0,function(t,e,i){return new m.a(function(a,s){try{v=v.map(function(a){return a.pj_id===t&&(a.name=e,a.code=i),a}),a()}catch(t){s(t)}})}(t,e,i).then(function(e){a.$message.success("编辑成功"),g().then(function(e){a.$store.dispatch("setProjectList",e),t===a.$store.state.currentProject.pj_id&&a.$store.dispatch("switchProject",e.filter(function(e){return e.pj_id===t})[0]),a.isSubmitting=!1,a.beforeClose()}).catch(function(){a.$message.error("获取项目信息失败")})}).catch(function(){a.$message.error("编辑项目失败"),a.isSubmitting=!1})}}},S={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form-dialog",{attrs:{title:t.isEdit?"编辑项目":"创建项目","certain-btn-text":t.isEdit?"保存":"创建","is-submitting":t.isSubmitting},on:{close:function(e){return t.beforeClose()},submit:function(e){return t.beforeSubmit()}}},[i("div",{staticClass:"form-line"},[i("label",[t._v("项目名称：")]),t._v(" "),i("v-input",{ref:"nameInput",attrs:{placeholder:"请输入项目名称"},model:{value:t.projectName.value,callback:function(e){t.$set(t.projectName,"value",e)},expression:"projectName.value"}}),t._v(" "),t.projectName.isOverCharLimit?i("p",{staticClass:"error-tip"},[t._v("项目名称不可超过 "+t._s(t.projectName.charLimit)+" 个字符")]):t._e(),t._v(" "),t.projectName.verificationTip?i("p",{staticClass:"error-tip"},[t._v(t._s(t.projectName.verificationTip))]):t._e()],1),t._v(" "),i("div",{staticClass:"form-line"},[i("label",[t._v("项目代号：")]),t._v(" "),i("v-input",{ref:"codeInput",attrs:{placeholder:"请输入项目代号"},model:{value:t.projectCode.value,callback:function(e){t.$set(t.projectCode,"value",e)},expression:"projectCode.value"}}),t._v(" "),t.projectCode.isOverCharLimit?i("p",{staticClass:"error-tip"},[t._v("项目代号不可超过 "+t._s(t.projectCode.charLimit)+" 个字符")]):t._e(),t._v(" "),t.projectCode.verificationTip?i("p",{staticClass:"error-tip"},[t._v(t._s(t.projectCode.verificationTip))]):t._e()],1)])},staticRenderFns:[]};var $=this,D={components:{createDialog:i("VU/8")(j,S,!1,function(t){i("Lkh9")},"data-v-16b49ca8",null).exports},data:function(){return{isCreateDgShow:!1,isOtherListShow:!1,projectBeingProcessed:{},isDeleting:!1,isDeleteDgShow:!1}},computed:l()({},Object(n.b)(["currentProject","projectList"]),{otherProject:function(){var t=this;return this.sortByName(this.projectList.filter(function(e){return e.pj_id!==t.currentProject.pj_id}))},isHover:function(){return this.projectBeingProcessed.pj_id?o()({},this.projectBeingProcessed.pj_id,!0):{}}}),methods:{switchProject:function(t){this.$store.dispatch("switchProject",t)},hideOtherList:function(){this.isCreateDgShow||this.isDeleteDgShow||(this.isOtherListShow=!1,this.projectBeingProcessed={})},closeCreateDg:function(){this.isCreateDgShow=!1,this.projectBeingProcessed={}},editProject:function(t){this.isCreateDgShow=!0},deleteProject:function(t){var e=this;this.projectBeingProcessed={},this.isDeleteDgShow=!0,this.$confirm("删除“"+t.name+"”项目，将同时删除该项目下所有数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){e.$message.warning("抱歉，没有删除权限"),e.isDeleteDgShow=!1}).catch(function(){e.isDeleteDgShow=!1})},sortByName:function(t){var e=function(t){return d()(t)[0][0].toLowerCase().charCodeAt(0)},i=function(t){var i=e(t);return i>=97&&i<=122},a=function(t){return!isNaN(parseInt(t,10))},s=t.filter(function(t){return a(t.name)}),n=t.filter(function(t){return!a(t.name)&&i(t.name)}),r=t.filter(function(t){return!a(t.name)&&!i(t.name)}),o=s.sort(function(t,e){return t.name.slice(0,1)-e.name.slice(0,1)}),c=n.sort(function(t,i){return e(t.name)-e(i.name)});return o.concat(c).concat(r)},handleMoreClick:function(t){this.projectBeingProcessed=this.projectBeingProcessed===t?{}:t},handleOtherListClick:function(){this.projectBeingProcessed={},this.isOtherListShow=!this.isOtherListShow}},directives:{"click-outside":{inserted:function(t,e,i){$.documentHandler=function(a){t.contains(a.target)||e.expression&&i.context[e.expression]()},document.addEventListener("click",$.documentHandler)},unbind:function(){document.removeEventListener("click",$.documentHandler)}}}},L={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"select-container"},[t.projectList.length?i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideOtherList,expression:"hideOtherList"}],staticClass:"sidebar-item clearfix",class:{current:t.isOtherListShow},on:{click:function(e){return t.handleOtherListClick()}}},[i("span",{staticClass:"icon iconfont icon-xiangmu"}),t._v(" "),i("span",{staticClass:"text ellipsis"},[t._v(t._s(t.currentProject.name))]),t._v(" "),i("span",{staticClass:"unfold-icon el-icon-caret-bottom"}),t._v(" "),i("el-popover",{ref:"more",attrs:{trigger:"manual",width:"60"},model:{value:t.isHover[t.currentProject.pj_id],callback:function(e){t.$set(t.isHover,t.currentProject.pj_id,e)},expression:"isHover[currentProject.pj_id]"}},[i("span",{on:{click:function(e){return t.editProject(t.currentProject)}}},[t._v("编辑")]),t._v(" "),i("span",{on:{click:function(e){return t.deleteProject(t.currentProject)}}},[t._v("删除")])]),t._v(" "),i("span",{staticClass:"more-icon",on:{click:function(e){return e.stopPropagation(),t.handleMoreClick(t.currentProject)}}},[i("span",{directives:[{name:"popover",rawName:"v-popover:more",arg:"more"}],staticClass:"fa fa-ellipsis-v"})])],1):i("div",{staticClass:"sidebar-item clearfix",on:{click:function(e){t.isCreateDgShow=!0}}},[i("span",{staticClass:"icon el-icon-plus"}),t._v(" "),i("span",{staticClass:"text ellipsis"},[t._v("添加项目")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isOtherListShow,expression:"isOtherListShow"}],staticClass:"project-list"},[i("ul",t._l(t.otherProject,function(e,a){return i("li",{key:a,staticClass:"sidebar-item clearfix",on:{click:function(i){return t.switchProject(e)}}},[i("span",{staticClass:"icon el-icon-arrow-right"}),t._v(" "),i("span",{staticClass:"text ellipsis"},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"unfold-icon"}),t._v(" "),i("el-popover",{ref:"more"+e.pj_id,refInFor:!0,attrs:{trigger:"manual",width:"60"},model:{value:t.isHover[e.pj_id],callback:function(i){t.$set(t.isHover,e.pj_id,i)},expression:"isHover[item.pj_id]"}},[i("span",{on:{click:function(i){return t.editProject(e)}}},[t._v("编辑")]),t._v(" "),i("span",{on:{click:function(i){return t.deleteProject(e)}}},[t._v("删除")])]),t._v(" "),i("span",{staticClass:"more-icon",class:{"current-more-icon":t.isHover[e.pj_id]},on:{click:function(i){return i.stopPropagation(),t.handleMoreClick(e)}}},[i("span",{directives:[{name:"popover",rawName:"v-popover",value:"more"+e.pj_id,expression:"'more' + item.pj_id"}],staticClass:"fa fa-ellipsis-v"})])],1)}),0),t._v(" "),i("hr"),t._v(" "),i("div",{staticClass:"sidebar-item clearfix",on:{click:function(e){t.isCreateDgShow=!0}}},[i("span",{staticClass:"icon el-icon-plus"}),t._v(" "),i("span",{staticClass:"text ellipsis"},[t._v("添加项目")])])]),t._v(" "),t.isCreateDgShow?i("create-dialog",{attrs:{project:t.projectBeingProcessed},on:{close:function(e){return t.closeCreateDg()}}}):t._e()],1)},staticRenderFns:[]};var k=i("VU/8")(D,L,!1,function(t){i("S3s9")},"data-v-6e0688e4",null).exports,T=i("jEgh"),O=i.n(T),P={props:{value:String,placeholder:String},data:function(){return{imgData:null,selection:null,files:[]}},mounted:function(){this.selection=window.getSelection()},methods:{getContent:function(){return this.$el.innerHTML.replace(/<br>/gi,"\n")},getFiles:function(){for(var t=/<img.*?data-name="(.+?)"/gi,e=[],i=void 0;null!==(i=t.exec(this.$el.innerHTML));){var a=O()(this.files,function(t){return t.fileName===i[1]});a&&e.push(a)}return e},focus:function(){this.$el.focus()},setContent:function(t){this.$el.innerHTML=t,this.files=[]},handleChange:function(t){this.$emit("change-value",t.target.innerHTML)},paste:function(t){t.stopPropagation(),t.preventDefault();var e=t.clipboardData||t.originalEvent.clipboardData,i=window.clipboardData,a=this.selection.getRangeAt(0);if(a.deleteContents(),!e.items||-1===e.items[0].type.search("image")){var s="";e&&e.getData?s=e.getData("text/plain"):i&&i.getData&&(s=i.getData("text"));var n=document.createTextNode(s);return a.insertNode(n),(a=a.cloneRange()).setStartAfter(n),a.collapse(!0),this.selection.removeAllRanges(),this.selection.addRange(a),!1}var r=e.items[0].getAsFile(),o=/image\/(.+)$/.exec(e.items[0].type)[1],c="event"+Date.now()+"."+o,l=document.createElement("img");l.dataset.name=c,this.files.push({file:r,fileName:c});var u=new FileReader;u.addEventListener("load",function(){l.src=u.result}),u.readAsDataURL(r),a.insertNode(l),(a=a.cloneRange()).setStartAfter(l),a.collapse(!0),this.selection.removeAllRanges(),this.selection.addRange(a)},insert:function(t){0===this.selection.rangeCount&&this.$el.focus();var e=this.selection.getRangeAt(0);e.deleteContents(),e.insertNode(t),(e=e.cloneRange()).setStartAfter(t),e.collapse(!0),this.selection.removeAllRanges(),this.selection.addRange(e)}}},U={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement;return(this._self._c||t)("div",{ref:"text",staticClass:"v-richtext",attrs:{contenteditable:"true",placeholder:this.placeholder,autofocus:""},on:{input:this.handleChange,paste:this.paste}},[this._v(this._s(this.value))])}]};var q={components:{richText:i("VU/8")(P,U,!1,function(t){i("8XJx")},null,null).exports,formDialog:y},data:function(){return{feedback:"",isSubmitting:!1}},mounted:function(){var t=this;setTimeout(function(){return t.$refs.richText.focus()},0)},methods:{changeValue:function(t){this.feedback=t},beforeClose:function(){this.$refs.richText.setContent(""),this.$emit("close")},beforeSubmit:function(){this.$message.success("反馈已提交"),this.$refs.richText.setContent(""),this.$refs.richText.focus()}}},N={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form-dialog",{staticClass:"feedback",attrs:{title:"意见反馈",width:"560px","certain-btn-text":"提交","is-submitting":t.isSubmitting},on:{close:function(e){return t.beforeClose()},submit:function(e){return t.beforeSubmit()}}},[i("rich-text",{ref:"richText",attrs:{value:t.feedback,placeholder:"支持纯文本和截图粘贴，不支持格式粘贴将被过滤"},on:{"change-value":t.changeValue}})],1)},staticRenderFns:[]};var E={components:{feedback:i("VU/8")(q,N,!1,function(t){i("u0M8")},null,null).exports,projectSelect:k},props:{username:{type:String,required:!0},avatar:{type:String,required:!0}},data:function(){return{isFeedbackShow:!1,navList:[{name:"问答库",path:"/qalibrary",icon:"icon-xinxiguanli"},{name:"数据统计",path:"/statistics",icon:"icon-barchart"},{name:"权限系统",path:"/authority",icon:"icon-idcard"}]}},computed:Object(n.b)(["projectList"]),methods:{logout:function(){location.href=s.logout}}},A={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("aside",{staticClass:"sidebar"},[i("header",[t._m(0),t._v(" "),i("project-select")],1),t._v(" "),i("hr"),t._v(" "),i("nav",[t.projectList.length?i("ul",t._l(t.navList,function(e,a){return i("li",{key:a,staticClass:"sidebar-item",class:{current:t.$route.path===e.path},on:{click:function(i){return t.$router.push({path:e.path,query:{pid:t.$store.state.currentProject.pj_id}})}}},[i("span",{staticClass:"icon iconfont",class:[e.icon]}),t._v(" "),i("span",{staticClass:"text ellipsis"},[t._v(t._s(e.name))])])}),0):t._e()]),t._v(" "),i("footer",{staticClass:"clearfix"},[i("div",{staticClass:"user-msg-container clearfix"},[i("el-popover",{ref:"logout",attrs:{trigger:"hover",width:"60"}},[i("span",{on:{click:function(e){return t.logout()}}},[t._v("退出")])]),t._v(" "),i("div",{staticClass:"user-msg"},[t._m(1),t._v(" "),i("span",{staticClass:"username ellipsis"},[t._v(t._s(t.username))])]),t._v(" "),i("span",{staticClass:"split"},[t._v("|")]),t._v(" "),i("span",{staticClass:"feedback",on:{click:function(e){t.isFeedbackShow=!0}}},[t._v("意见反馈")])],1)]),t._v(" "),t.isFeedbackShow?i("feedback",{on:{close:function(e){t.isFeedbackShow=!1}}}):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"logo"},[e("span",{staticClass:"icon iconfont icon-wenda"}),this._v("问答管理系统")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"avatar"},[e("img",{attrs:{src:i("zQrT")}})])}]};var V={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"no-access"},[this._m(0),this._v(" "),e("p",{staticClass:"concats-tip"},[this._v("申请项目权限或接入项目，可联系\n    "),e("span",{staticClass:"link",on:{click:this.openConcatDialog}},[this._v("系统管理员")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"clearfix"},[e("span",{staticClass:"fa fa-info-circle warning-icon"}),this._v(" "),e("p",{staticClass:"warning-title"},[this._v("你当前未拥有项目")])])}]};function R(t,e,i){return t.some(function(t){return t[e]===i})}var z={name:"app",components:{sidebar:i("VU/8")(E,A,!1,function(t){i("ILMH"),i("KWGG")},"data-v-3d2e76f6",null).exports,noAccess:i("VU/8")({data:function(){return{}},methods:{openConcatDialog:function(){}}},V,!1,function(t){i("ji+F")},"data-v-1d163594",null).exports},data:function(){return{avatar:"",username:"",isLoading:!1,hasAccess:!1}},watch:{currentProject:function(t){localStorage.currentProjectId=t&&t.pj_id,t?this.$router.push({path:"/qalibrary",query:{page:"home",pid:t.pj_id}}):this.$router.push("/welcome")}},computed:Object(n.b)(["currentProject"]),created:function(){this.getUserData()},methods:{getUserData:function(){this.isLoading=!0,window.$avatar="../assets/img/avatar.png",this.avatar=window.$avatar,window.$username="罗大雄",this.username=window.$username,window.$userEmail="sx.Luo@foxmail.com",this.getProjectData()},getProjectData:function(){var t=this;g().then(function(e){var i,a,s,n=e;if(console.log(n),t.$store.dispatch("setProjectList",n),n.length){t.hasAccess=!0;var r=t.$route.query.pid;r&&R(n,"pj_id",r)||(r=localStorage.currentProjectId)&&R(n,"pj_id",r)||(r=n[0].pj_id),t.$store.dispatch("switchProject",(i=n,a="pj_id",s=r,i.filter(function(t){return t[a]===s}))[0])}else"admin@qq.com"===window.$userEmail&&(t.hasAccess=!0,t.$store.dispatch("switchProject",void 0));t.isLoading=!1}).catch(function(){t.$message.error("获取项目信息失败")})}}},F={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"clearfix",attrs:{id:"app"}},[!t.isLoading&&t.hasAccess?[i("sidebar",{attrs:{username:t.username,avatar:t.avatar}}),t._v(" "),i("main",[i("router-view")],1)]:t._e(),t._v(" "),t.isLoading||t.hasAccess?t._e():i("no-access")],2)},staticRenderFns:[]};var I=i("VU/8")(z,F,!1,function(t){i("xPbY")},null,null).exports,B=i("/ocq"),H=i("XLwt"),Q=i.n(H),M={name:"comment_trend",props:{options:{type:Object,required:!0},data:{type:Object,required:!0},isLoading:{type:Boolean}},data:function(){return{myChart:null,hasChoose:!0}},mounted:function(){this.initGraph()},watch:{data:function(){this.setOption(this.myChart)},isLoading:function(){this.isLoading?this.myChart.showLoading():this.myChart.hideLoading()}},methods:{initGraph:function(){var t=this,e=Q.a.init(this.$refs.echart);this.myChart=e,e.showLoading(),e.setOption(this.options),e.on("legendselectchanged",function(e){t.$emit("change-legend",e.name);var i=e.selected;for(var a in i)if(i[a])return void(t.hasChoose=!0);t.hasChoose=!1}),this.setOption(e)},setOption:function(t){t.setOption({color:this.data.color,legend:{data:this.data.legend||[],selected:this.data.selected||[]},xAxis:[{data:this.data.xAxis}],series:this.data.series})}}},J={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{ref:"echart",staticStyle:{height:"300px",padding:"20px 0 0 16px"}})},staticRenderFns:[]};var W=i("VU/8")(M,J,!1,function(t){i("NsAA")},"data-v-7e52506b",null).exports,G=function(){return{tooltip:{trigger:"axis",formatter:function(t){for(var e=t[0].name,i=0;i<t.length;i++)e=e+'<br/><span style="color:'+t[i].color+';font-size: 20px;">● </span>'+t[i].seriesName+":"+(100*t[i].value).toFixed(2)+"%";return e}},legend:{selectedMode:"multiple",selected:{},data:[]},color:["#669cd8","#fdd900","#e9a280","#a1ca8c","#b35750","#9c8ff3"],xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{axisLabel:{formatter:function(t){return(100*t).toFixed(2)+"%"}}},series:[],animationDuration:500}},Y={name:"comment_trend",components:{chart:W},data:function(){return{chartData:{},chartOptions:G(),isLoading:!0}},created:function(){this.loadData()},methods:{loadData:function(){var t=this;this.isLoading=!0;var e={praise:[.123,.66323,.03234,.00165,.8,0,0,0,.3454,.22222,.55555,0],bad_review:[.763,.26323,0,0,.43234,.22165,.6,0,.3454,.44444,.11115,0],general_review:[.423,.16323,.13234,.33165,.1,0,.3454,0,0,.64222,5e-5,0]};setTimeout(function(){t.chartData={legend:["好评率","差评率","中评率"],selected:{"好评率":!0,"差评率":!0,"中评率":!0},xAxis:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],series:[{name:"好评率",legendHoverLink:!0,type:"line",data:e.praise},{name:"差评率",legendHoverLink:!0,type:"line",data:e.bad_review},{name:"中评率",legendHoverLink:!0,type:"line",data:e.general_review}]},t.isLoading=!1},1e3)}}},X={render:function(){var t=this.$createElement;return(this._self._c||t)("chart",{attrs:{data:this.chartData,options:this.chartOptions,"is-loading":this.isLoading}})},staticRenderFns:[]};var K=function(){return{tooltip:{trigger:"axis",formatter:function(t){for(var e=t[0].name,i=0;i<t.length-1;i++)e=e+'<br/><span style="color:'+t[i].color+';font-size: 20px;">● </span>'+t[i].seriesName+":"+(100*t[i].value).toFixed(2)+"%";return e}},legend:{selectedMode:"multiple",data:[]},color:["#669cd8","#fdd900","#e9a280","#a1ca8c","#b35750","#9c8ff3"],xAxis:{type:"category",boundaryGap:!0,axisTick:{alignWithLabel:!0},data:[]},yAxis:[{type:"value"}],series:[],animationDuration:500}},Z={name:"comment_trend",components:{chart:W},data:function(){return{chartData:{},chartOptions:K(),legend:["活跃用户数","新增用户数","聊天总数"],isLoading:!0}},created:function(){this.loadData()},methods:{loadData:function(){var t=this;this.isLoading=!0;var e=[{date:"2019-02-24",value:0},{date:"2019-02-25",value:0},{date:"2019-02-26",value:2},{date:"2019-02-27",value:3},{date:"2019-02-28",value:4},{date:"2019-03-01",value:1},{date:"2019-03-02",value:0},{date:"2019-03-03",value:0},{date:"2019-03-04",value:1},{date:"2019-03-05",value:1},{date:"2019-03-06",value:1},{date:"2019-03-07",value:1},{date:"2019-03-08",value:1},{date:"2019-03-09",value:0},{date:"2019-03-10",value:0}],i=e.map(function(t){return t.value});setTimeout(function(){t.chartData={legend:t.legend,selected:{"活跃用户数":!0,"新增用户数":!1,"聊天总数":!1},xAxis:e.map(function(t){return t.date}),series:[{name:t.legend[0],legendHoverLink:!0,type:"bar",data:i},{name:t.legend[1],legendHoverLink:!0,type:"bar",data:i},{name:t.legend[2],legendHoverLink:!0,type:"bar",data:i},{name:t.legend[0]+"",showAllSymbol:!0,legendHoverLink:!0,type:"line",data:i}]},t.isLoading=!1},1e3)}}},tt={render:function(){var t=this.$createElement;return(this._self._c||t)("chart",{attrs:{data:this.chartData,options:this.chartOptions,"is-loading":this.isLoading}})},staticRenderFns:[]};var et={name:"index",components:{commentTrend:i("VU/8")(Y,X,!1,function(t){i("V1Za")},"data-v-1c1c0fe0",null).exports,barEchart:i("VU/8")(Z,tt,!1,function(t){i("mcbk")},"data-v-3ad8da92",null).exports}},it={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"statistics clearfix"},[e("div",{staticClass:"card"},[e("comment-trend")],1),this._v(" "),e("div",{staticClass:"card"},[e("bar-echart")],1)])},staticRenderFns:[]};var at=i("VU/8")(et,it,!1,function(t){i("aIbP")},"data-v-4264ddb8",null).exports,st=[{qid:"0",time:+new Date,question:"测试",answer:"答案",cls:2,favorite_num:180,upvoted_num:80,status:!0,start:+new Date-1,end:+new Date+86400},{qid:"1",time:+new Date,question:"这是一个问题",answer:"这是一个答案",cls:1,favorite_num:100,upvoted_num:100,status:!0,start:+new Date-1,end:+new Date+86400}];var nt={props:{data:{type:Object,required:!0}},data:function(){return{classifications:this.$store.state.currentProject.cls,statusOptions:["生效中","未生效"],type:{question:"问题",answer:"答案",all:"不限"},placeholders:{question:"请输入问题",answer:"请输入答案",all:"请输入问题或答案"}}},methods:{changeFilter:function(){this.$emit("get-data")},search:function(){this.$message.warning("搜索功能暂不可用")}}},rt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"filter-bar"},[i("div",{staticClass:"radio-group"},[i("div",{staticClass:"form-line clearfix"},[i("label",{staticClass:"label"},[t._v("分类：")]),t._v(" "),i("el-radio-group",{attrs:{size:"small"},on:{change:t.changeFilter},model:{value:t.data.classification,callback:function(e){t.$set(t.data,"classification",e)},expression:"data.classification"}},[i("el-radio-button",{attrs:{label:-1}},[t._v("全部")]),t._v(" "),t._l(t.classifications,function(e,a){return[i("el-radio-button",{key:a,attrs:{label:a}},[t._v(t._s(e))])]})],2)],1),t._v(" "),i("div",{staticClass:"form-line clearfix"},[i("label",{staticClass:"label"},[t._v("状态：")]),t._v(" "),i("el-radio-group",{attrs:{size:"small"},on:{change:t.changeFilter},model:{value:t.data.status,callback:function(e){t.$set(t.data,"status",e)},expression:"data.status"}},[i("el-radio-button",{attrs:{label:-1}},[t._v("全部")]),t._v(" "),t._l(t.statusOptions,function(e,a){return[i("el-radio-button",{key:a,attrs:{label:1-a}},[t._v(t._s(e))])]})],2)],1)]),t._v(" "),i("div",{staticClass:"search-input"},[i("el-input",{staticClass:"input-with-select",attrs:{placeholder:t.placeholders[t.data.searchType]},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.data.searchWord,callback:function(e){t.$set(t.data,"searchWord",e)},expression:"data.searchWord"}},[i("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.data.searchType,callback:function(e){t.$set(t.data,"searchType",e)},expression:"data.searchType"}},[t._l(t.type,function(t,e){return[i("el-option",{key:e,attrs:{label:t,value:e}})]})],2),t._v(" "),i("span",{staticClass:"search-icon el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:t.search},slot:"suffix"})],1)],1)])},staticRenderFns:[]};var ot=i("VU/8")(nt,rt,!1,function(t){i("6iW9"),i("1+h8")},"data-v-f3ba0cae",null).exports;var ct={props:{total:{type:Number,required:!0},pageData:{type:Object,required:!0},tableData:{type:Array,required:!0}},data:function(){return{classifications:this.$store.state.currentProject.cls}},methods:{handleCurrentChange:function(t){this.pageData.pageIndex=t,this.$emit("get-data")},handleSizeChange:function(t){this.pageData.pageSize=t,this.$emit("get-data")},sortChange:function(t){this.pageData.sortType=t.prop,this.pageData.reverse="descending"===t.order,this.$emit("get-data")},openDialog:function(t){this.$emit("open-dg",t)},deleteData:function(t){var e=this;this.$confirm("删除数据后将不可恢复，确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){(function(t){return new m.a(function(e,i){try{st=st.filter(function(e){return e.qid!==t}),e()}catch(t){i(t)}})})(t).then(function(t){e.$message.success("删除成功"),e.$emit("update-list")}).catch(function(t){e.$message.error("删除失败")})}).catch(function(){})}},filters:{formatTime:function(t){var e=new Date(+new Date(t)+28800);return e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)+" "+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)}}},lt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"clearfix"},[i("el-table",{staticStyle:{width:"100%","margin-top":"25px"},attrs:{data:t.tableData,border:""},on:{"sort-change":t.sortChange}},[i("el-table-column",{attrs:{prop:"time",label:"更新时间",sortable:"custom","sort-orders":["descending","ascending"],resizable:!1,align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("formatTime")(e.row.time))+"\n      ")]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"问题",resizable:!1,align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"link ellipsis",attrs:{title:e.row.question},on:{click:function(i){return t.openDialog(e.row)}}},[t._v(t._s(e.row.question))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"答案",resizable:!1,align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"ellipsis",attrs:{title:e.row.answer}},[t._v(t._s(e.row.answer))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"分类",resizable:!1,align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t.classifications[e.row.cls]))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"favorite_num",label:"收藏数",sortable:"custom","sort-orders":["descending","ascending"],resizable:!1,align:"center",width:"90"}}),t._v(" "),i("el-table-column",{attrs:{prop:"upvoted_num",label:"点赞数",sortable:"custom","sort-orders":["descending","ascending"],resizable:!1,align:"center",width:"90"}}),t._v(" "),i("el-table-column",{attrs:{label:"状态",resizable:!1,align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{directives:[{name:"show",rawName:"v-show",value:!1===e.row.status,expression:"scope.row.status === false"}],staticStyle:{color:"#F00"}},[t._v("未生效")]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!0===e.row.status,expression:"scope.row.status === true"}]},[t._v("生效中")])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"110",resizable:!1,align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"link edit-btn",on:{click:function(i){return t.openDialog(e.row,"edit")}}},[t._v("编辑")]),t._v(" "),i("span",{staticClass:"link delete-btn",on:{click:function(i){return t.deleteData(e.row.qid)}}},[t._v("删除")])]}}])})],1),t._v(" "),t.tableData.length?i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{"current-page":t.pageData.pageIndex,"page-sizes":t.pageData.pageSizes,"page-size":t.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()],1)},staticRenderFns:[]},ut=i("VU/8")(ct,lt,!1,null,null,null).exports,dt={components:{formDialog:y,vInput:C},props:{type:{type:String},currentData:{type:Object}},data:function(){return{queCharLimit:50,isQueOverCharLimit:!1,queVerificationTip:"",ansCharLimit:5e3,isAnsOverCharLimit:!1,ansVerificationTip:"",isSubmitting:!1,data:"edit"===this.type?this.currentData:{cls:0,question:"",answer:"",start:"",end:""},originalJSON:"",classifications:["分类一","分类二","分类三"]}},watch:{"data.question":function(t){this.isQueOverCharLimit=t.length>this.queCharLimit,this.isQueOverCharLimit&&(this.queVerificationTip="")},"data.answer":function(t){this.isAnsOverCharLimit=t.length>this.ansCharLimit,this.isAnsOverCharLimit&&(this.ansVerificationTip="")}},computed:{isEdit:function(){return"edit"===this.type},isTimeError:function(){return this.data.start&&this.data.end&&this.data.start>this.data.end}},created:function(){this.init()},mounted:function(){var t=this;setTimeout(function(){return t.$refs.input.$children[0].focus()},0)},methods:{init:function(){this.originalJSON=p()(this.data)},beforeClose:function(){var t=this;p()(this.data)===this.originalJSON?this.close():this.$confirm("此弹窗有编辑内容未保存，是否关闭该弹窗","提示",{confirmButtonText:"关闭",cancelButtonText:"取消",closeOnClickModal:!1}).then(function(){t.close()}).catch(function(){})},close:function(){this.$emit("close")},beforeSubmit:function(){this.isQueOverCharLimit||this.data.question?this.isAnsOverCharLimit||this.data.answer?this.isTimeError||(p()(this.data)===this.originalJSON?this.close():this.isEdit?this.update():this.create()):this.ansVerificationTip="答案不能为空":this.queVerificationTip="问题不能为空"},create:function(){this.isSubmitting=!0;try{!function(t,e,i,a,s){var n=Date.now();st.splice(0,0,{qid:st.length,time:+new Date,question:e,answer:i,cls:t,favorite_num:0,upvoted_num:0,status:a<=n&&s>=n,start:a,end:s})}(this.data.cls,this.data.question,this.data.answer,this.getTimestamp(this.data.start),this.getTimestamp(this.data.end)),this.originalJSON=p()(this.data),this.$message.success("添加成功"),this.$emit("update-list"),this.isSubmitting=!1,this.beforeClose()}catch(t){this.$message.error("添加失败"),this.isSubmitting=!1}},update:function(){this.isSubmitting=!0;try{!function(t,e,i,a,s,n){var r=Date.now();st=st.map(function(o){return o.qid===t&&(o.cls=e,o.question=i,o.answer=a,o.start=s,o.end=n,o.status=s<=r&&n>=r),o})}(this.data.qid,this.data.cls,this.data.question,this.data.answer,this.getTimestamp(this.data.start),this.getTimestamp(this.data.end)),this.originalJSON=p()(this.data),this.$message.success("编辑成功"),this.$emit("update-list"),this.isSubmitting=!1,this.beforeClose()}catch(t){this.$message.error("编辑失败"),this.isSubmitting=!1}},getTimestamp:function(t){return+new Date(t)}}},ht={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form-dialog",{staticClass:"add-question-dg",attrs:{title:t.isEdit?"编辑问答":"添加问答","certain-btn-text":t.isEdit?"保存":"添加","is-submitting":t.isSubmitting,width:"720px"},on:{close:function(e){return t.beforeClose()},submit:function(e){return t.beforeSubmit()}}},[i("div",{staticClass:"form-line clearfix"},[i("label",{staticClass:"label"},[t._v("分类：")]),t._v(" "),i("el-radio-group",{attrs:{size:"small"},model:{value:t.data.cls,callback:function(e){t.$set(t.data,"cls",e)},expression:"data.cls"}},[t._l(t.classifications,function(e,a){return[i("el-radio-button",{key:a,attrs:{label:a}},[t._v(t._s(e))])]})],2)],1),t._v(" "),i("div",{staticClass:"form-line clearfix"},[i("label",{staticClass:"label"},[t._v("问题：")]),t._v(" "),i("v-input",{ref:"input",attrs:{placeholder:"请输入问题"},model:{value:t.data.question,callback:function(e){t.$set(t.data,"question",e)},expression:"data.question"}}),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:t.isQueOverCharLimit,expression:"isQueOverCharLimit"}],staticClass:"error-tip"},[t._v("问题不可超过 "+t._s(t.queCharLimit)+" 个字符")]),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:!t.isQueOverCharLimit&&t.queVerificationTip,expression:"!isQueOverCharLimit && queVerificationTip"}],staticClass:"error-tip"},[t._v(t._s(t.queVerificationTip))])],1),t._v(" "),i("div",{staticClass:"form-line clearfix"},[i("label",{staticClass:"label"},[t._v("答案：")]),t._v(" "),i("v-input",{attrs:{type:"textarea",rows:8.5,placeholder:"请输入答案"},model:{value:t.data.answer,callback:function(e){t.$set(t.data,"answer",e)},expression:"data.answer"}}),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:t.isAnsOverCharLimit,expression:"isAnsOverCharLimit"}],staticClass:"error-tip"},[t._v("答案不可超过 "+t._s(t.ansCharLimit)+" 个字符")]),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:!t.isAnsOverCharLimit&&t.ansVerificationTip,expression:"!isAnsOverCharLimit && ansVerificationTip"}],staticClass:"error-tip"},[t._v(t._s(t.ansVerificationTip))])],1),t._v(" "),i("div",{staticClass:"form-line clearfix"},[i("label",{staticClass:"label"},[t._v("有效期：")]),t._v(" "),i("div",{staticClass:"start-time"},[i("el-date-picker",{attrs:{type:"datetime",editable:!1,placeholder:"生效时间，为空表示即时生效"},model:{value:t.data.start,callback:function(e){t.$set(t.data,"start",e)},expression:"data.start"}})],1),t._v(" "),i("span",{staticClass:"joiner"},[t._v("-")]),t._v(" "),i("div",{staticClass:"end-time"},[i("el-date-picker",{attrs:{type:"datetime",editable:!1,placeholder:"失效时间，为空表示生效后永不失效"},model:{value:t.data.end,callback:function(e){t.$set(t.data,"end",e)},expression:"data.end"}})],1),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:t.isTimeError,expression:"isTimeError"}],staticClass:"error-tip"},[t._v("生效时间不可大于失效时间")])])])},staticRenderFns:[]};var pt={components:{filterBar:ot,qaTable:ut,addQuestionDg:i("VU/8")(dt,ht,!1,function(t){i("/Cih"),i("1t/z")},"data-v-8965840c",null).exports},props:{pageData:{type:Object,required:!0}},data:function(){return{total:10,isAddQueDgShow:!1,queDgType:"add",currentDetails:{},tableData:[]}},created:function(){this.getData()},methods:{getData:function(){var t,e,i=this;(t=this.pageData.classification,e=this.pageData.status,new m.a(function(i,a){try{i(st.filter(function(i){return-1===e?-1===t||t===i.cls:-1===t?i.status===Boolean(e):i.status===Boolean(e)&&i.cls===t}))}catch(t){a(t)}})).then(function(t){i.tableData=t}).catch(function(){i.$message.error("获取列表数据失败")})},openAddQueDg:function(t){this.queDgType=t,this.isAddQueDgShow=!0},viewDetails:function(t){this.currentDetails=t,this.openAddQueDg("edit")},closeAddQueDg:function(){this.isAddQueDgShow=!1,this.currentDetails={}}}},ft={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"home"},[i("div",{staticClass:"header-box relative"},[i("filter-bar",{attrs:{data:t.pageData},on:{"get-data":t.getData}}),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.openAddQueDg("add")}}},[t._v("添加问答")])],1),t._v(" "),i("qa-table",{attrs:{"page-data":t.pageData,"table-data":t.tableData,total:t.total},on:{"open-dg":t.viewDetails,"update-list":t.getData}}),t._v(" "),t.isAddQueDgShow?i("add-question-dg",{attrs:{"current-data":t.currentDetails,type:t.queDgType},on:{close:t.closeAddQueDg,"update-list":t.getData}}):t._e()],1)},staticRenderFns:[]};var mt={pageOptions:[10,20,50,100],pageSize:10},vt={components:{homePage:i("VU/8")(pt,ft,!1,function(t){i("3S2X")},"data-v-c6140cd6",null).exports},data:function(){return{homePageData:{classification:-1,status:-1,searchType:"question",searchWord:"",sortType:"time",reverse:!0,pageIndex:1,pageSize:mt.pageSize,pageSizes:mt.pageOptions},quePageData:{searchWord:"",sortType:0,pageIndex:1,pageSize:mt.pageSize,pageSizes:mt.pageOptions},ansPageData:{searchWord:"",sortType:0,pageIndex:1,pageSize:mt.pageSize,pageSizes:mt.pageOptions},commentPageData:{searchWord:"",sortType:0,pageIndex:1,pageSize:mt.pageSize,pageSizes:mt.pageOptions}}},methods:{}},gt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"body-container"},[e("home-page",{attrs:{"page-data":this.homePageData}})],1)},staticRenderFns:[]},_t=i("VU/8")(vt,gt,!1,null,null,null).exports,bt=i("Gu7T"),Ct=i.n(bt),xt={senior:[{email:"luodaxiong@youxiang.com",code:6666,name:"罗大雄"},{email:"luoxiaoxiong@youxiang.com",code:8888,name:"罗小雄"}],ordinary:[]},wt=[{email:"luodaxiong@youxiang.com",code:6666,name:"罗大雄",deptname:"总裁部"},{email:"luoxiaoxiong@youxiang.com",code:8888,name:"罗小雄",deptname:"人事部"},{email:"xiongda@youxiang.com",code:9999,name:"熊大",deptname:"财务部"},{email:"xionger@youxiang.com",code:1111,name:"熊二",deptname:"技术部"},{email:"zhangsan@youxiang.com",code:2222,name:"张三",deptname:"行政部"},{email:"lisi@youxiang.com",code:3333,name:"李四",deptname:"公关部"},{email:"wangwu@youxiang.com",code:4444,name:"王五",deptname:"运维部"},{email:"zhaoliu@youxiang.com",code:5555,name:"赵六",deptname:"运营部"}];function yt(){return JSON.parse(p()(xt))}function jt(t,e){xt[e]=xt[e].concat(t.addedUsers),xt[e]=xt[e].filter(function(e){for(var i=0;i<t.deletedUsers.length;i++)if(e.email===t.deletedUsers[i].email)return!1;return!0})}var St={props:{users:{type:Array,required:!0},allUsers:{type:Array,required:!0}},data:function(){return{search:"",matchUsers:[]}},watch:{search:function(t){t.trim()?this.searchUser(t):this.matchUsers=[]}},methods:{searchUser:function(t){var e,i=(e=t,wt.filter(function(t){return String(t.code).indexOf(e)>-1||t.name.indexOf(e)>-1}));try{this.matchUsers=i.sort(function(t){var e=new RegExp(escape(t).replace(/%u/g,"\\u"));return function(t){return t.name.match(e)?-1:1}}(t)).slice(0,10)}catch(t){throw this.$message.error("搜索用户出错"),new Error(t)}},deleteUser:function(t){this.users.splice(t,1),this.$emit("change-user")},addUser:function(t){var e=this;this.allUsers.some(function(e){return e.email===t.email})?this.$message.warning("每位成员只能拥有一个角色，请重新设置"):(this.users.push({email:t.email,code:t.code||"",name:t.name}),this.$emit("change-user")),this.clearMatch(),setTimeout(function(){e.focusInput()},0)},clearMatch:function(){this.search="",this.matchUsers=[]},addFirstUser:function(){this.matchUsers.length&&this.addUser(this.matchUsers[0])},focusInput:function(){this.$refs.input.focus()}},filters:{html:function(t){return t?"<"+t+">":""},attr:function(t){return t?"["+t+"]":""}}},$t={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-box clearfix"},[t._l(t.users,function(e,a){return i("div",{key:a,staticClass:"user"},[t._v("\n    "+t._s(e.name)+"\n    "),i("span",{staticClass:"delete-btn el-icon-close",on:{click:function(e){return t.deleteUser(a)}}}),t._v(" "),i("div",{staticClass:"user-detail",class:{"no-code":!e.code}},[i("span",[t._v(t._s(e.name))]),t._v(" "),i("span",[t._v(t._s(t._f("html")(e.code)))])])])}),t._v(" "),i("div",{staticClass:"searchbar"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],ref:"input",staticClass:"search-input",attrs:{type:"text",placeholder:"请点击添加管理员...",debounce:"100"},domProps:{value:t.search},on:{blur:t.clearMatch,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addFirstUser(e)},input:function(e){e.target.composing||(t.search=e.target.value)}}}),t._v(" "),t.matchUsers.length?i("ul",{staticClass:"match-users-list list-unstyled"},t._l(t.matchUsers,function(e,a){return i("li",{key:a,staticClass:"match-user",on:{mousedown:function(i){return t.addUser(e)}}},[t._v("\n        "+t._s(e.name)+t._s(t._f("html")(e.code))+t._s(t._f("attr")(e.deptname))+"\n      ")])}),0):t._e()])],2)},staticRenderFns:[]};var Dt={components:{authNameBox:i("VU/8")(St,$t,!1,function(t){i("if5y")},"data-v-5ca9b3cd",null).exports},data:function(){return{users:{senior:[],ordinary:[]},originalUsers:{},isLoading:!0,isSubmitting:!1,addedUsers:{senior:[],ordinary:[]},deletedUsers:{senior:[],ordinary:[]}}},computed:{hasChanged:function(){return p()(this.users)!==p()(this.originalUsers)},allUsers:function(){return[].concat(Ct()(this.users.senior),Ct()(this.users.ordinary))}},created:function(){this.getData()},mounted:function(){var t=this;setTimeout(function(){t.focusInput()},0)},beforeRouteLeave:function(t,e,i){var a=this;this.hasChanged?this.$confirm("此页面有编辑内容未保存，是否离开该页面","提示",{confirmButtonText:"离开",cancelButtonText:"取消",closeOnClickModal:!1}).then(function(){i()}).catch(function(){i(!1),a.focusInput()}):i()},methods:{getData:function(){this.isLoading=!0;try{this.users=yt(),this.originalUsers=JSON.parse(p()(this.users)),this.isLoading=!1}catch(t){this.$message.error("获取管理员数据失败")}},changeSeniorUser:function(){this.filterChangedUsers(this.users.senior,this.originalUsers.senior,"senior")},changeOrdinaryUser:function(){this.filterChangedUsers(this.users.ordinary,this.originalUsers.ordinary,"ordinary")},filterChangedUsers:function(t,e,i){this.addedUsers[i]=t.filter(function(t){return!e.some(function(e){return e.email===t.email})}),this.deletedUsers[i]=e.filter(function(e){return!t.some(function(t){return t.email===e.email})})},save:function(){if(this.hasChanged){this.isSubmitting=!0;var t={senior:{addedUsers:this.addedUsers.senior,deletedUsers:this.deletedUsers.senior},ordinary:{addedUsers:this.addedUsers.ordinary,deletedUsers:this.deletedUsers.ordinary}};try{e=t.ordinary,jt(t.senior,"senior"),jt(e,"ordinary"),this.users=yt(),this.isSubmitting=!1,this.$message.success("编辑成功"),this.originalUsers=JSON.parse(p()(this.users))}catch(t){this.$message.error("编辑失败"),this.isSubmitting=!1}}var e},focusInput:function(){this.$refs.authBox.$refs.input.focus()}}},Lt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"authority-management body-container"},[t._m(0),t._v(" "),i("dl",{staticClass:"manager-box"},[i("dt",[t._v("高级管理员：")]),t._v(" "),i("dd",[i("auth-name-box",{ref:"authBox",attrs:{users:t.users.senior,"all-users":t.allUsers},on:{"change-user":t.changeSeniorUser}})],1),t._v(" "),i("dt",[t._v("普通管理员：")]),t._v(" "),i("dd",[i("auth-name-box",{attrs:{users:t.users.ordinary,"all-users":t.allUsers},on:{"change-user":t.changeOrdinaryUser}})],1)]),t._v(" "),i("footer",[i("el-button",{attrs:{type:"primary",loading:t.isSubmitting,disabled:!t.hasChanged},on:{click:t.save}},[t._v("保存")])],1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"description"},[i("p",[t._v("说明：")]),t._v(" "),i("p",[t._v("1.普通管理员可管理项目，亦可查看相关统计数据")]),t._v(" "),i("p",[t._v("2.高级管理员除拥有普通管理员权限外，还可以进行权限管理")]),t._v(" "),i("p",[t._v("3.支持中文和代号搜索，如输入“3333”、“熊”可搜索用户，如有疑问请联系 "),i("em",[t._v("<sx.luo@foxmail.com>")])])])}]};var kt=i("VU/8")(Dt,Lt,!1,function(t){i("YAb1")},"data-v-8aaf0558",null).exports;a.default.use(B.a);var Tt=new B.a({routes:[{path:"/",name:"qalibrary",component:_t},{path:"/qalibrary",name:"qalibrary",component:_t},{path:"/statistics",name:"statistics",component:at},{path:"/authority",name:"authority",component:kt}]}),Ot=i("zL8q"),Pt=i.n(Ot),Ut=(i("tvR6"),i("8+8L"));a.default.use(Ut.a),a.default.http.interceptors.push(function(t,e){e(function(t){if(200===t.status){if(t.data&&0===t.data.code&&(t.data.Result=1),1===t.data.Result)return t;2===t.data.Result&&setTimeout(function(){location.href="loginIndex"},2200),t.ok=!1}else t.ok=!1})}),a.default.use(n.a);var qt=new n.a.Store({state:{currentProject:{},projectList:[]},getters:{getCurrentProject:function(t){return t.currentProject},getProjectList:function(t){return t.projectList}},mutations:{SWITCH_PROJECT:function(t,e){t.currentProject=e},SET_PROJECT_LIST:function(t,e){t.projectList=e}},actions:{switchProject:function(t,e){(0,t.commit)("SWITCH_PROJECT",e)},setProjectList:function(t,e){(0,t.commit)("SET_PROJECT_LIST",e)}}});a.default.use(Pt.a),a.default.config.productionTip=!1,new a.default({el:"#app",router:Tt,store:qt,components:{App:I},template:"<App/>"})},NsAA:function(t,e){},PbDA:function(t,e){},S3s9:function(t,e){},V1Za:function(t,e){},YAb1:function(t,e){},aIbP:function(t,e){},if5y:function(t,e){},"ji+F":function(t,e){},mcbk:function(t,e){},tvR6:function(t,e){},u0M8:function(t,e){},xPbY:function(t,e){},zQrT:function(t,e,i){t.exports=i.p+"static/img/avatar.9b64c1a.png"}},["NHnr"]);
//# sourceMappingURL=app.3f942e07bd9d06b62b0a.js.map